{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Tarak/Desktop/mokshainvestment/mokshainvestment/utils/supabase/client.ts"],"sourcesContent":["// import { createBrowserClient } from \"@supabase/ssr\";\r\n\r\n// export function createClient() {\r\n//   return createBrowserClient(\r\n//     process.env.NEXT_PUBLIC_SUPABASE_URL as string,\r\n//     process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY as string\r\n//   );\r\n// }\r\n\r\n// import { createClient as createSupabaseClient } from \"@supabase/supabase-js\";\r\n\r\n// const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\n// const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\n// const supabase = createSupabaseClient(supabaseUrl, supabaseAnonKey);\r\n\r\n// export default supabase;\r\n// utils/supabase/client.ts\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\nconst supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n\r\nexport default supabase;\r\n\r\n\r\n\r\n"],"names":[],"mappings":"AAAA,uDAAuD;AAEvD,mCAAmC;AACnC,gCAAgC;AAChC,sDAAsD;AACtD,0DAA0D;AAC1D,OAAO;AACP,IAAI;AAEJ,gFAAgF;AAEhF,6DAA6D;AAC7D,sEAAsE;AAEtE,uEAAuE;AAEvE,2BAA2B;AAC3B,2BAA2B;;;;;AAGP;AAFpB;;AAEA,MAAM;AACN,MAAM;AAEN,MAAM,WAAW,IAAA,8NAAY,EAAC,aAAa;uCAE5B","debugId":null}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Tarak/Desktop/mokshainvestment/mokshainvestment/app/admin/companies/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport supabase from \"@/utils/supabase/client\";\r\n\r\ninterface Category {\r\n  id: string;\r\n  name: string;\r\n}\r\n\r\ninterface Subcategory {\r\n  id: string;\r\n  name: string;\r\n  category_id: string;\r\n}\r\n\r\ninterface Company {\r\n  id: string;\r\n  name: string;\r\n  category_id: string;\r\n  subcategory_id: string | null;\r\n  logo_url: string | null;\r\n  is_active: boolean;\r\n  category?: Category;\r\n  subcategory?: Subcategory;\r\n}\r\n\r\nconst CompaniesAdmin = () => {\r\n  const [companies, setCompanies] = useState<Company[]>([]);\r\n  const [categories, setCategories] = useState<Category[]>([]);\r\n  const [subcategories, setSubcategories] = useState<Subcategory[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [form, setForm] = useState<Partial<Company>>({\r\n    name: \"\",\r\n    category_id: \"\",\r\n    subcategory_id: \"\",\r\n    logo_url: \"\",\r\n  });\r\n  const [editing, setEditing] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetchCategories();\r\n    fetchCompanies();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (form.category_id) fetchSubcategories(form.category_id);\r\n    else setSubcategories([]);\r\n  }, [form.category_id]);\r\n\r\n  const fetchCategories = async () => {\r\n    const { data, error } = await supabase\r\n      .from(\"insurance_categories\")\r\n      .select(\"*\")\r\n      .eq(\"is_active\", true);\r\n    if (error) return console.error(error.message);\r\n    setCategories(data as Category[]);\r\n  };\r\n\r\n  const fetchSubcategories = async (category_id: string) => {\r\n    const { data, error } = await supabase\r\n      .from(\"insurance_subcategories\")\r\n      .select(\"*\")\r\n      .eq(\"category_id\", category_id)\r\n      .eq(\"is_active\", true);\r\n    if (error) return console.error(error.message);\r\n    setSubcategories(data as Subcategory[]);\r\n  };\r\n\r\n  const fetchCompanies = async () => {\r\n    setLoading(true);\r\n    const { data, error } = await supabase\r\n      .from(\"insurance_companies\")\r\n      .select(\r\n        \"*, category:insurance_categories(id,name), subcategory:insurance_subcategories(id,name)\"\r\n      )\r\n      .eq(\"is_active\", true)\r\n      .order(\"created_at\", { ascending: false });\r\n\r\n    if (error) {\r\n      console.error(error.message);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    setCompanies(data as Company[]);\r\n    setLoading(false);\r\n  };\r\n\r\n  const handleFileUpload = async (file: File) => {\r\n    const fileName = `${Date.now()}_${file.name}`;\r\n\r\n    // Upload file\r\n    const { error } = await supabase.storage\r\n      .from(\"company-logos\")\r\n      .upload(fileName, file);\r\n\r\n    if (error) {\r\n      alert(\"Upload failed: \" + error.message);\r\n      return;\r\n    }\r\n\r\n    // Get public URL (âš¡ fixed destructuring)\r\n    const { data, error: urlError } = supabase.storage\r\n      .from(\"company-logos\")\r\n      .getPublicUrl(fileName);\r\n\r\n    if (urlError) {\r\n      alert(\"URL fetch failed: \" + urlError.message);\r\n      return;\r\n    }\r\n\r\n    setForm({ ...form, logo_url: data.publicUrl });\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!form.name || !form.category_id)\r\n      return alert(\"Name and Category are required\");\r\n\r\n    if (editing && form.id) {\r\n      const { error } = await supabase\r\n        .from(\"insurance_companies\")\r\n        .update({\r\n          name: form.name,\r\n          category_id: form.category_id,\r\n          subcategory_id: form.subcategory_id,\r\n          logo_url: form.logo_url,\r\n        })\r\n        .eq(\"id\", form.id);\r\n\r\n      if (error) return alert(error.message);\r\n    } else {\r\n      const { error } = await supabase.from(\"insurance_companies\").insert({\r\n        name: form.name,\r\n        category_id: form.category_id,\r\n        subcategory_id: form.subcategory_id,\r\n        logo_url: form.logo_url,\r\n        is_active: true,\r\n      });\r\n\r\n      if (error) return alert(error.message);\r\n    }\r\n\r\n    setForm({ name: \"\", category_id: \"\", subcategory_id: \"\", logo_url: \"\" });\r\n    setEditing(false);\r\n    fetchCompanies();\r\n  };\r\n\r\n  const handleEdit = (company: Company) => {\r\n    setForm({ ...company });\r\n    setEditing(true);\r\n  };\r\n\r\n  const handleDelete = async (id: string) => {\r\n    if (!confirm(\"Are you sure you want to delete this company?\")) return;\r\n    const { error } = await supabase\r\n      .from(\"insurance_companies\")\r\n      .update({ is_active: false })\r\n      .eq(\"id\", id);\r\n    if (error) return alert(error.message);\r\n    fetchCompanies();\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-8\">\r\n      <h1 className=\"text-2xl font-bold mb-4\">Manage Companies</h1>\r\n\r\n      <form\r\n        onSubmit={handleSubmit}\r\n        className=\"mb-6 p-4 border rounded-lg bg-white shadow-sm\"\r\n      >\r\n        <div className=\"flex flex-col md:flex-row gap-4 items-center\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Company Name\"\r\n            value={form.name || \"\"}\r\n            onChange={(e) => setForm({ ...form, name: e.target.value })}\r\n            className=\"border px-3 py-2 rounded w-full\"\r\n          />\r\n          <select\r\n            value={form.category_id || \"\"}\r\n            onChange={(e) =>\r\n              setForm({\r\n                ...form,\r\n                category_id: e.target.value,\r\n                subcategory_id: \"\",\r\n              })\r\n            }\r\n            className=\"border px-3 py-2 rounded w-full\"\r\n          >\r\n            <option value=\"\">Select Category</option>\r\n            {categories.map((cat) => (\r\n              <option key={cat.id} value={cat.id}>\r\n                {cat.name}\r\n              </option>\r\n            ))}\r\n          </select>\r\n\r\n          <select\r\n            value={form.subcategory_id || \"\"}\r\n            onChange={(e) => setForm({ ...form, subcategory_id: e.target.value })}\r\n            className=\"border px-3 py-2 rounded w-full\"\r\n            disabled={!subcategories.length}\r\n          >\r\n            <option value=\"\">Select Subcategory</option>\r\n            {subcategories.map((sub) => (\r\n              <option key={sub.id} value={sub.id}>\r\n                {sub.name}\r\n              </option>\r\n            ))}\r\n          </select>\r\n\r\n          <input\r\n            type=\"file\"\r\n            accept=\"image/*\"\r\n            onChange={(e) =>\r\n              e.target.files?.[0] && handleFileUpload(e.target.files[0])\r\n            }\r\n            className=\"border px-3 py-2 rounded w-full\"\r\n          />\r\n\r\n          <button\r\n            type=\"submit\"\r\n            className=\"bg-indigo-600 text-white px-4 py-2 rounded\"\r\n          >\r\n            {editing ? \"Update\" : \"Add\"}\r\n          </button>\r\n        </div>\r\n\r\n        {form.logo_url && (\r\n          <img\r\n            src={form.logo_url}\r\n            alt=\"Preview\"\r\n            className=\"mt-2 w-32 h-32 object-cover border rounded\"\r\n          />\r\n        )}\r\n      </form>\r\n\r\n      {loading ? (\r\n        <p>Loading companies...</p>\r\n      ) : (\r\n        <table className=\"w-full border-collapse\">\r\n          <thead>\r\n            <tr className=\"bg-gray-100\">\r\n              <th className=\"border px-3 py-2 text-left\">Name</th>\r\n              <th className=\"border px-3 py-2 text-left\">Category</th>\r\n              <th className=\"border px-3 py-2 text-left\">Subcategory</th>\r\n              <th className=\"border px-3 py-2 text-left\">Logo</th>\r\n              <th className=\"border px-3 py-2\">Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {companies.map((c) => (\r\n              <tr key={c.id} className=\"hover:bg-gray-50\">\r\n                <td className=\"border px-3 py-2\">{c.name}</td>\r\n                <td className=\"border px-3 py-2\">{c.category?.name}</td>\r\n                <td className=\"border px-3 py-2\">{c.subcategory?.name}</td>\r\n                <td className=\"border px-3 py-2\">\r\n                  {c.logo_url && (\r\n                    <img\r\n                      src={c.logo_url}\r\n                      alt={c.name}\r\n                      className=\"w-20 h-20 object-cover\"\r\n                    />\r\n                  )}\r\n                </td>\r\n                <td className=\"border px-3 py-2 flex gap-2 justify-center\">\r\n                  <button\r\n                    onClick={() => handleEdit(c)}\r\n                    className=\"bg-yellow-400 text-white px-2 py-1 rounded\"\r\n                  >\r\n                    Edit\r\n                  </button>\r\n                  <button\r\n                    onClick={() => handleDelete(c.id)}\r\n                    className=\"bg-red-500 text-white px-2 py-1 rounded\"\r\n                  >\r\n                    Delete\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CompaniesAdmin;\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AA2BA,MAAM,iBAAiB;;IACrB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,6LAAQ,EAAY,EAAE;IACxD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,6LAAQ,EAAa,EAAE;IAC3D,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,6LAAQ,EAAgB,EAAE;IACpE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6LAAQ,EAAC;IACvC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,6LAAQ,EAAmB;QACjD,MAAM;QACN,aAAa;QACb,gBAAgB;QAChB,UAAU;IACZ;IACA,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6LAAQ,EAAC;IAEvC,IAAA,8LAAS;oCAAC;YACR;YACA;QACF;mCAAG,EAAE;IAEL,IAAA,8LAAS;oCAAC;YACR,IAAI,KAAK,WAAW,EAAE,mBAAmB,KAAK,WAAW;iBACpD,iBAAiB,EAAE;QAC1B;mCAAG;QAAC,KAAK,WAAW;KAAC;IAErB,MAAM,kBAAkB;QACtB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,6JAAQ,CACnC,IAAI,CAAC,wBACL,MAAM,CAAC,KACP,EAAE,CAAC,aAAa;QACnB,IAAI,OAAO,OAAO,QAAQ,KAAK,CAAC,MAAM,OAAO;QAC7C,cAAc;IAChB;IAEA,MAAM,qBAAqB,OAAO;QAChC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,6JAAQ,CACnC,IAAI,CAAC,2BACL,MAAM,CAAC,KACP,EAAE,CAAC,eAAe,aAClB,EAAE,CAAC,aAAa;QACnB,IAAI,OAAO,OAAO,QAAQ,KAAK,CAAC,MAAM,OAAO;QAC7C,iBAAiB;IACnB;IAEA,MAAM,iBAAiB;QACrB,WAAW;QACX,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,6JAAQ,CACnC,IAAI,CAAC,uBACL,MAAM,CACL,2FAED,EAAE,CAAC,aAAa,MAChB,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE1C,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,MAAM,OAAO;YAC3B,WAAW;YACX;QACF;QACA,aAAa;QACb,WAAW;IACb;IAEA,MAAM,mBAAmB,OAAO;QAC9B,MAAM,WAAW,AAAC,GAAgB,OAAd,KAAK,GAAG,IAAG,KAAa,OAAV,KAAK,IAAI;QAE3C,cAAc;QACd,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,6JAAQ,CAAC,OAAO,CACrC,IAAI,CAAC,iBACL,MAAM,CAAC,UAAU;QAEpB,IAAI,OAAO;YACT,MAAM,oBAAoB,MAAM,OAAO;YACvC;QACF;QAEA,yCAAyC;QACzC,MAAM,EAAE,IAAI,EAAE,OAAO,QAAQ,EAAE,GAAG,6JAAQ,CAAC,OAAO,CAC/C,IAAI,CAAC,iBACL,YAAY,CAAC;QAEhB,IAAI,UAAU;YACZ,MAAM,uBAAuB,SAAS,OAAO;YAC7C;QACF;QAEA,QAAQ;YAAE,GAAG,IAAI;YAAE,UAAU,KAAK,SAAS;QAAC;IAC9C;IAEA,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAChB,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,WAAW,EACjC,OAAO,MAAM;QAEf,IAAI,WAAW,KAAK,EAAE,EAAE;YACtB,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,6JAAQ,CAC7B,IAAI,CAAC,uBACL,MAAM,CAAC;gBACN,MAAM,KAAK,IAAI;gBACf,aAAa,KAAK,WAAW;gBAC7B,gBAAgB,KAAK,cAAc;gBACnC,UAAU,KAAK,QAAQ;YACzB,GACC,EAAE,CAAC,MAAM,KAAK,EAAE;YAEnB,IAAI,OAAO,OAAO,MAAM,MAAM,OAAO;QACvC,OAAO;YACL,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,6JAAQ,CAAC,IAAI,CAAC,uBAAuB,MAAM,CAAC;gBAClE,MAAM,KAAK,IAAI;gBACf,aAAa,KAAK,WAAW;gBAC7B,gBAAgB,KAAK,cAAc;gBACnC,UAAU,KAAK,QAAQ;gBACvB,WAAW;YACb;YAEA,IAAI,OAAO,OAAO,MAAM,MAAM,OAAO;QACvC;QAEA,QAAQ;YAAE,MAAM;YAAI,aAAa;YAAI,gBAAgB;YAAI,UAAU;QAAG;QACtE,WAAW;QACX;IACF;IAEA,MAAM,aAAa,CAAC;QAClB,QAAQ;YAAE,GAAG,OAAO;QAAC;QACrB,WAAW;IACb;IAEA,MAAM,eAAe,OAAO;QAC1B,IAAI,CAAC,QAAQ,kDAAkD;QAC/D,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,6JAAQ,CAC7B,IAAI,CAAC,uBACL,MAAM,CAAC;YAAE,WAAW;QAAM,GAC1B,EAAE,CAAC,MAAM;QACZ,IAAI,OAAO,OAAO,MAAM,MAAM,OAAO;QACrC;IACF;IAEA,qBACE,iNAAC;QAAI,WAAU;;0BACb,iNAAC;gBAAG,WAAU;0BAA0B;;;;;;0BAExC,iNAAC;gBACC,UAAU;gBACV,WAAU;;kCAEV,iNAAC;wBAAI,WAAU;;0CACb,iNAAC;gCACC,MAAK;gCACL,aAAY;gCACZ,OAAO,KAAK,IAAI,IAAI;gCACpB,UAAU,CAAC,IAAM,QAAQ;wCAAE,GAAG,IAAI;wCAAE,MAAM,EAAE,MAAM,CAAC,KAAK;oCAAC;gCACzD,WAAU;;;;;;0CAEZ,iNAAC;gCACC,OAAO,KAAK,WAAW,IAAI;gCAC3B,UAAU,CAAC,IACT,QAAQ;wCACN,GAAG,IAAI;wCACP,aAAa,EAAE,MAAM,CAAC,KAAK;wCAC3B,gBAAgB;oCAClB;gCAEF,WAAU;;kDAEV,iNAAC;wCAAO,OAAM;kDAAG;;;;;;oCAChB,WAAW,GAAG,CAAC,CAAC,oBACf,iNAAC;4CAAoB,OAAO,IAAI,EAAE;sDAC/B,IAAI,IAAI;2CADE,IAAI,EAAE;;;;;;;;;;;0CAMvB,iNAAC;gCACC,OAAO,KAAK,cAAc,IAAI;gCAC9B,UAAU,CAAC,IAAM,QAAQ;wCAAE,GAAG,IAAI;wCAAE,gBAAgB,EAAE,MAAM,CAAC,KAAK;oCAAC;gCACnE,WAAU;gCACV,UAAU,CAAC,cAAc,MAAM;;kDAE/B,iNAAC;wCAAO,OAAM;kDAAG;;;;;;oCAChB,cAAc,GAAG,CAAC,CAAC,oBAClB,iNAAC;4CAAoB,OAAO,IAAI,EAAE;sDAC/B,IAAI,IAAI;2CADE,IAAI,EAAE;;;;;;;;;;;0CAMvB,iNAAC;gCACC,MAAK;gCACL,QAAO;gCACP,UAAU,CAAC;wCACT;2CAAA,EAAA,kBAAA,EAAE,MAAM,CAAC,KAAK,cAAd,sCAAA,eAAgB,CAAC,EAAE,KAAI,iBAAiB,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE;;gCAE3D,WAAU;;;;;;0CAGZ,iNAAC;gCACC,MAAK;gCACL,WAAU;0CAET,UAAU,WAAW;;;;;;;;;;;;oBAIzB,KAAK,QAAQ,kBACZ,iNAAC;wBACC,KAAK,KAAK,QAAQ;wBAClB,KAAI;wBACJ,WAAU;;;;;;;;;;;;YAKf,wBACC,iNAAC;0BAAE;;;;;yEAEH,iNAAC;gBAAM,WAAU;;kCACf,iNAAC;kCACC,cAAA,iNAAC;4BAAG,WAAU;;8CACZ,iNAAC;oCAAG,WAAU;8CAA6B;;;;;;8CAC3C,iNAAC;oCAAG,WAAU;8CAA6B;;;;;;8CAC3C,iNAAC;oCAAG,WAAU;8CAA6B;;;;;;8CAC3C,iNAAC;oCAAG,WAAU;8CAA6B;;;;;;8CAC3C,iNAAC;oCAAG,WAAU;8CAAmB;;;;;;;;;;;;;;;;;kCAGrC,iNAAC;kCACE,UAAU,GAAG,CAAC,CAAC;gCAGsB,aACA;iDAHpC,iNAAC;gCAAc,WAAU;;kDACvB,iNAAC;wCAAG,WAAU;kDAAoB,EAAE,IAAI;;;;;;kDACxC,iNAAC;wCAAG,WAAU;mDAAoB,cAAA,EAAE,QAAQ,cAAV,kCAAA,YAAY,IAAI;;;;;;kDAClD,iNAAC;wCAAG,WAAU;mDAAoB,iBAAA,EAAE,WAAW,cAAb,qCAAA,eAAe,IAAI;;;;;;kDACrD,iNAAC;wCAAG,WAAU;kDACX,EAAE,QAAQ,kBACT,iNAAC;4CACC,KAAK,EAAE,QAAQ;4CACf,KAAK,EAAE,IAAI;4CACX,WAAU;;;;;;;;;;;kDAIhB,iNAAC;wCAAG,WAAU;;0DACZ,iNAAC;gDACC,SAAS,IAAM,WAAW;gDAC1B,WAAU;0DACX;;;;;;0DAGD,iNAAC;gDACC,SAAS,IAAM,aAAa,EAAE,EAAE;gDAChC,WAAU;0DACX;;;;;;;;;;;;;+BAvBI,EAAE,EAAE;;;;;;;;;;;;;;;;;;;;;;;AAkC3B;GApQM;KAAA;uCAsQS","debugId":null}}]
}