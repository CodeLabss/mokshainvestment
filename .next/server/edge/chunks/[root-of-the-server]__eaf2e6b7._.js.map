{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import 'stream')"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`stream`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,MAAM,CAAC"}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import 'crypto')"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`crypto`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,MAAM,CAAC"}},
    {"offset": {"line": 30, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/mokshainvestment/middleware.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport type { NextRequest } from \"next/server\";\r\nimport jwt from \"jsonwebtoken\";\r\n\r\nexport function middleware(req: NextRequest) {\r\n  const url = req.nextUrl.clone();\r\n\r\n  // allow login page without auth\r\n  if (url.pathname === \"/admin/login\") {\r\n    return NextResponse.next();\r\n  }\r\n\r\n  if (url.pathname.startsWith(\"/admin\")) {\r\n    const token = req.cookies.get(\"admin_token\")?.value;\r\n\r\n    if (!token) {\r\n      // Check if user is trying to access dashboard after login\r\n      if (url.pathname === \"/admin/dashboard\") {\r\n        console.log(\"No token found, redirecting to login\");\r\n      }\r\n      url.pathname = \"/admin/login\";\r\n      return NextResponse.redirect(url);\r\n    }\r\n\r\n    try {\r\n      jwt.verify(token, process.env.JWT_SECRET as string);\r\n      return NextResponse.next();\r\n    } catch (err) {\r\n      console.log(\"Token verification failed:\", err);\r\n      url.pathname = \"/admin/login\";\r\n      return NextResponse.redirect(url);\r\n    }\r\n  }\r\n\r\n  return NextResponse.next();\r\n}\r\n\r\nexport const config = {\r\n  matcher: [\"/admin/:path*\"],\r\n};\r\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAEA;;;AAEO,SAAS,WAAW,GAAgB;IACzC,MAAM,MAAM,IAAI,OAAO,CAAC,KAAK;IAE7B,gCAAgC;IAChC,IAAI,IAAI,QAAQ,KAAK,gBAAgB;QACnC,OAAO,oNAAY,CAAC,IAAI;IAC1B;IAEA,IAAI,IAAI,QAAQ,CAAC,UAAU,CAAC,WAAW;QACrC,MAAM,QAAQ,IAAI,OAAO,CAAC,GAAG,CAAC,gBAAgB;QAE9C,IAAI,CAAC,OAAO;YACV,0DAA0D;YAC1D,IAAI,IAAI,QAAQ,KAAK,oBAAoB;gBACvC,QAAQ,GAAG,CAAC;YACd;YACA,IAAI,QAAQ,GAAG;YACf,OAAO,oNAAY,CAAC,QAAQ,CAAC;QAC/B;QAEA,IAAI;YACF,4KAAG,CAAC,MAAM,CAAC,OAAO,QAAQ,GAAG,CAAC,UAAU;YACxC,OAAO,oNAAY,CAAC,IAAI;QAC1B,EAAE,OAAO,KAAK;YACZ,QAAQ,GAAG,CAAC,8BAA8B;YAC1C,IAAI,QAAQ,GAAG;YACf,OAAO,oNAAY,CAAC,QAAQ,CAAC;QAC/B;IACF;IAEA,OAAO,oNAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAgB;AAC5B"}}]
}