{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Tarak/Desktop/mokshainvestment/mokshainvestment/app/admin/dashboard/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\n// Use service role key for admin operations to bypass RLS\r\nconst supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\nexport default function DashboardPage() {\r\n  const router = useRouter();\r\n  const [name, setName] = useState(\"\");\r\n  const [logo, setLogo] = useState<File | null>(null);\r\n  const [companies, setCompanies] = useState<any[]>([]);\r\n\r\n  useEffect(() => {\r\n    const isAdmin = localStorage.getItem(\"isAdmin\");\r\n    if (!isAdmin) router.push(\"/admin/login\");\r\n\r\n    fetchCompanies();\r\n  }, [router]);\r\n\r\n  async function fetchCompanies() {\r\n    const { data } = await supabase.from(\"insurance_companies\").select(\"*\").order(\"created_at\", { ascending: false });\r\n    if (data) setCompanies(data);\r\n  }\r\n\r\n  async function handleSubmit(e: React.FormEvent) {\r\n    e.preventDefault();\r\n\r\n    let logoUrl = null;\r\n\r\n    if (logo) {\r\n      const fileName = `${Date.now()}-${logo.name}`;\r\n      const { data, error } = await supabase.storage\r\n        .from(\"company-logos\")\r\n        .upload(fileName, logo);\r\n\r\n      if (error) {\r\n        console.error(error);\r\n        return;\r\n      }\r\n\r\n      const { data: publicUrl } = supabase.storage\r\n        .from(\"company-logos\")\r\n        .getPublicUrl(fileName);\r\n\r\n      logoUrl = publicUrl.publicUrl;\r\n    }\r\n\r\n    const { error } = await supabase.from(\"insurance_companies\").insert([\r\n      { name, logo_url: logoUrl },\r\n    ]);\r\n\r\n    if (error) {\r\n      console.error(error);\r\n    } else {\r\n      setName(\"\");\r\n      setLogo(null);\r\n      fetchCompanies();\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <h1 className=\"text-2xl font-bold mb-6\">Admin Dashboard</h1>\r\n\r\n      {/* Add Company Form */}\r\n      <form onSubmit={handleSubmit} className=\"bg-white p-4 rounded shadow-md mb-6 w-96\">\r\n        <h2 className=\"text-lg font-semibold mb-4\">Add Insurance Company</h2>\r\n\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Company Name\"\r\n          className=\"w-full border p-2 mb-3 rounded\"\r\n          value={name}\r\n          onChange={(e) => setName(e.target.value)}\r\n          required\r\n        />\r\n\r\n        <input\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          className=\"w-full mb-3\"\r\n          onChange={(e) => setLogo(e.target.files?.[0] || null)}\r\n        />\r\n\r\n        <button type=\"submit\" className=\"w-full bg-blue-600 text-white p-2 rounded\">\r\n          Add Company\r\n        </button>\r\n      </form>\r\n\r\n      {/* Companies List */}\r\n      <h2 className=\"text-lg font-semibold mb-3\">Existing Companies</h2>\r\n      <div className=\"grid grid-cols-2 gap-4\">\r\n        {companies.map((company) => (\r\n          <div key={company.id} className=\"border p-3 rounded flex items-center gap-3\">\r\n            {company.logo_url && (\r\n              <img src={company.logo_url} alt={company.name} className=\"w-12 h-12 object-contain\" />\r\n            )}\r\n            <span>{company.name}</span>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMA,0DAA0D;AAC1D,MAAM,WAAW,IAAA,2NAAY,gFAE3B,QAAQ,GAAG,CAAC,yBAAyB;AAGxB,SAAS;IACtB,MAAM,SAAS,IAAA,mKAAS;IACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,qOAAQ,EAAC;IACjC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,qOAAQ,EAAc;IAC9C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,qOAAQ,EAAQ,EAAE;IAEpD,IAAA,sOAAS,EAAC;QACR,MAAM,UAAU,aAAa,OAAO,CAAC;QACrC,IAAI,CAAC,SAAS,OAAO,IAAI,CAAC;QAE1B;IACF,GAAG;QAAC;KAAO;IAEX,eAAe;QACb,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,uBAAuB,MAAM,CAAC,KAAK,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAC/G,IAAI,MAAM,aAAa;IACzB;IAEA,eAAe,aAAa,CAAkB;QAC5C,EAAE,cAAc;QAEhB,IAAI,UAAU;QAEd,IAAI,MAAM;YACR,MAAM,WAAW,GAAG,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,IAAI,EAAE;YAC7C,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,OAAO,CAC3C,IAAI,CAAC,iBACL,MAAM,CAAC,UAAU;YAEpB,IAAI,OAAO;gBACT,QAAQ,KAAK,CAAC;gBACd;YACF;YAEA,MAAM,EAAE,MAAM,SAAS,EAAE,GAAG,SAAS,OAAO,CACzC,IAAI,CAAC,iBACL,YAAY,CAAC;YAEhB,UAAU,UAAU,SAAS;QAC/B;QAEA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,uBAAuB,MAAM,CAAC;YAClE;gBAAE;gBAAM,UAAU;YAAQ;SAC3B;QAED,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC;QAChB,OAAO;YACL,QAAQ;YACR,QAAQ;YACR;QACF;IACF;IAEA,qBACE,kQAAC;QAAI,WAAU;;0BACb,kQAAC;gBAAG,WAAU;0BAA0B;;;;;;0BAGxC,kQAAC;gBAAK,UAAU;gBAAc,WAAU;;kCACtC,kQAAC;wBAAG,WAAU;kCAA6B;;;;;;kCAE3C,kQAAC;wBACC,MAAK;wBACL,aAAY;wBACZ,WAAU;wBACV,OAAO;wBACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;wBACvC,QAAQ;;;;;;kCAGV,kQAAC;wBACC,MAAK;wBACL,QAAO;wBACP,WAAU;wBACV,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,IAAI;;;;;;kCAGlD,kQAAC;wBAAO,MAAK;wBAAS,WAAU;kCAA4C;;;;;;;;;;;;0BAM9E,kQAAC;gBAAG,WAAU;0BAA6B;;;;;;0BAC3C,kQAAC;gBAAI,WAAU;0BACZ,UAAU,GAAG,CAAC,CAAC,wBACd,kQAAC;wBAAqB,WAAU;;4BAC7B,QAAQ,QAAQ,kBACf,kQAAC;gCAAI,KAAK,QAAQ,QAAQ;gCAAE,KAAK,QAAQ,IAAI;gCAAE,WAAU;;;;;;0CAE3D,kQAAC;0CAAM,QAAQ,IAAI;;;;;;;uBAJX,QAAQ,EAAE;;;;;;;;;;;;;;;;AAU9B","debugId":null}}]
}