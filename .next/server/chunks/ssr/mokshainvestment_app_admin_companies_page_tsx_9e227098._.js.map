{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Tarak/Desktop/mokshainvestment/mokshainvestment/app/admin/companies/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\n\r\ninterface Category {\r\n  id: string;\r\n  name: string;\r\n}\r\n\r\ninterface Subcategory {\r\n  id: string;\r\n  name: string;\r\n}\r\n\r\ninterface Company {\r\n  id: string;\r\n  name: string;\r\n  description: string | null;\r\n  category_id: string;\r\n  subcategory_id: string | null;\r\n  category?: Category;\r\n  subcategory?: Subcategory;\r\n  website_url: string | null;\r\n  logo_url: string;\r\n  is_active: boolean;\r\n}\r\n\r\nconst CompaniesAdmin = () => {\r\n  const [companies, setCompanies] = useState<Company[]>([]);\r\n  const [categories, setCategories] = useState<Category[]>([]);\r\n  const [subcategories, setSubcategories] = useState<Subcategory[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [form, setForm] = useState<Partial<Company>>({});\r\n  const [editing, setEditing] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetchCategories();\r\n    fetchCompanies();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (form.category_id) fetchSubcategories(form.category_id);\r\n  }, [form.category_id]);\r\n\r\n  // Fetch all active categories\r\n  const fetchCategories = async () => {\r\n    const res = await fetch(\"/api/admin/categories\");\r\n    const data = await res.json();\r\n    setCategories(data.categories || []);\r\n  };\r\n\r\n  // Fetch subcategories for a selected category\r\n  const fetchSubcategories = async (category_id: string) => {\r\n    const res = await fetch(\"/api/admin/subcategories\");\r\n    const data = await res.json();\r\n    const filtered = (data.subcategories || []).filter((s: Subcategory) => s.category_id === category_id);\r\n    setSubcategories(filtered);\r\n  };\r\n\r\n  // Fetch all active companies\r\n  const fetchCompanies = async () => {\r\n    setLoading(true);\r\n    const res = await fetch(\"/api/admin/companies\");\r\n    const data = await res.json();\r\n    setCompanies(data.companies || []);\r\n    setLoading(false);\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!form.name || !form.category_id || !form.logo_url) return alert(\"Name, Category, and Logo URL are required\");\r\n\r\n    const method = editing ? \"PUT\" : \"POST\";\r\n    const body = JSON.stringify(form);\r\n\r\n    const res = await fetch(\"/api/admin/companies\", { method, body });\r\n    const data = await res.json();\r\n\r\n    if (data.error) return alert(data.error);\r\n\r\n    setForm({});\r\n    setEditing(false);\r\n    fetchCompanies();\r\n  };\r\n\r\n  const handleEdit = (company: Company) => {\r\n    setForm({\r\n      ...company,\r\n      category_id: company.category_id,\r\n      subcategory_id: company.subcategory_id,\r\n    });\r\n    setEditing(true);\r\n  };\r\n\r\n  const handleDelete = async (id: string) => {\r\n    if (!confirm(\"Are you sure you want to delete this company?\")) return;\r\n    const res = await fetch(`/api/admin/companies/${id}`, { method: \"DELETE\" });\r\n    const data = await res.json();\r\n    if (data.error) return alert(data.error);\r\n    fetchCompanies();\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-8\">\r\n      <h1 className=\"text-2xl font-bold mb-4\">Manage Companies</h1>\r\n\r\n      <form onSubmit={handleSubmit} className=\"mb-6 p-4 border rounded-lg bg-white shadow-sm flex flex-col md:flex-row gap-4\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Company Name\"\r\n          value={form.name || \"\"}\r\n          onChange={(e) => setForm({ ...form, name: e.target.value })}\r\n          className=\"border px-3 py-2 rounded w-full\"\r\n        />\r\n        <select\r\n          value={form.category_id || \"\"}\r\n          onChange={(e) => setForm({ ...form, category_id: e.target.value, subcategory_id: \"\" })}\r\n          className=\"border px-3 py-2 rounded w-full\"\r\n        >\r\n          <option value=\"\">Select Category</option>\r\n          {categories.map((cat) => (\r\n            <option key={cat.id} value={cat.id}>{cat.name}</option>\r\n          ))}\r\n        </select>\r\n        <select\r\n          value={form.subcategory_id || \"\"}\r\n          onChange={(e) => setForm({ ...form, subcategory_id: e.target.value })}\r\n          className=\"border px-3 py-2 rounded w-full\"\r\n        >\r\n          <option value=\"\">Select Subcategory (optional)</option>\r\n          {subcategories.map((sub) => (\r\n            <option key={sub.id} value={sub.id}>{sub.name}</option>\r\n          ))}\r\n        </select>\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Website URL\"\r\n          value={form.website_url || \"\"}\r\n          onChange={(e) => setForm({ ...form, website_url: e.target.value })}\r\n          className=\"border px-3 py-2 rounded w-full\"\r\n        />\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Logo URL\"\r\n          value={form.logo_url || \"\"}\r\n          onChange={(e) => setForm({ ...form, logo_url: e.target.value })}\r\n          className=\"border px-3 py-2 rounded w-full\"\r\n        />\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Description\"\r\n          value={form.description || \"\"}\r\n          onChange={(e) => setForm({ ...form, description: e.target.value })}\r\n          className=\"border px-3 py-2 rounded w-full\"\r\n        />\r\n        <button type=\"submit\" className=\"bg-indigo-600 text-white px-4 py-2 rounded\">{editing ? \"Update\" : \"Add\"}</button>\r\n      </form>\r\n\r\n      {loading ? (\r\n        <p>Loading companies...</p>\r\n      ) : (\r\n        <table className=\"w-full border-collapse\">\r\n          <thead>\r\n            <tr className=\"bg-gray-100\">\r\n              <th className=\"border px-3 py-2\">Name</th>\r\n              <th className=\"border px-3 py-2\">Category</th>\r\n              <th className=\"border px-3 py-2\">Subcategory</th>\r\n              <th className=\"border px-3 py-2\">Website</th>\r\n              <th className=\"border px-3 py-2\">Logo</th>\r\n              <th className=\"border px-3 py-2\">Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {companies.map((company) => (\r\n              <tr key={company.id} className=\"hover:bg-gray-50\">\r\n                <td className=\"border px-3 py-2\">{company.name}</td>\r\n                <td className=\"border px-3 py-2\">{company.category?.name}</td>\r\n                <td className=\"border px-3 py-2\">{company.subcategory?.name || \"-\"}</td>\r\n                <td className=\"border px-3 py-2\">{company.website_url || \"-\"}</td>\r\n                <td className=\"border px-3 py-2\"><img src={company.logo_url} alt={company.name} className=\"h-10 w-10 object-cover\" /></td>\r\n                <td className=\"border px-3 py-2 flex gap-2 justify-center\">\r\n                  <button onClick={() => handleEdit(company)} className=\"bg-yellow-400 text-white px-2 py-1 rounded\">Edit</button>\r\n                  <button onClick={() => handleDelete(company.id)} className=\"bg-red-500 text-white px-2 py-1 rounded\">Delete</button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CompaniesAdmin;\r\n"],"names":[],"mappings":"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","debugId":null}}]
}