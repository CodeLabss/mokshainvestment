{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Tarak/Desktop/mokshainvestment/mokshainvestment/lib/supabaseClient.ts"],"sourcesContent":["// lib/supabaseClient.ts\r\n\"use client\";\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\nconst URL = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst ANON = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\nexport const supabase = createClient(URL, ANON, {\r\n  auth: {\r\n    persistSession: true,\r\n    autoRefreshToken: true,\r\n    detectSessionInUrl: false\r\n  },\r\n});"],"names":[],"mappings":"AAAA,wBAAwB;;;;;AAExB;AADA;;AAGA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,2NAAY,EAAC,KAAK,MAAM;IAC9C,MAAM;QACJ,gBAAgB;QAChB,kBAAkB;QAClB,oBAAoB;IACtB;AACF","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Tarak/Desktop/mokshainvestment/mokshainvestment/app/admin/dashboard/page.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { supabase } from \"@/lib/supabaseClient\";\r\nimport { motion } from \"framer-motion\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\ntype LeadRow = {\r\n  id: string;\r\n  name: string;\r\n  phone: string;\r\n  email?: string;\r\n  requirement?: string;\r\n  notes?: string;\r\n  is_contacted?: boolean;\r\n  created_at?: string;\r\n};\r\n\r\nexport default function AdminDashboardPage() {\r\n  const [leads, setLeads] = useState<LeadRow[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [authChecked, setAuthChecked] = useState(false);\r\n  const router = useRouter();\r\n\r\n  // Check authentication on component mount\r\n  useEffect(() => {\r\n    checkAuth();\r\n  }, []);\r\n\r\n  async function checkAuth() {\r\n    const { data: { session } } = await supabase.auth.getSession();\r\n    console.log(\"Auth check session:\", session);\r\n    \r\n    if (!session) {\r\n      console.log(\"No session, redirecting to login\");\r\n      router.push('/admin/login');\r\n      return;\r\n    }\r\n    \r\n    setAuthChecked(true);\r\n    fetchLeads();\r\n  }\r\n\r\n  async function fetchLeads() {\r\n    try {\r\n      setLoading(true);\r\n      const { data, error } = await supabase\r\n        .from('leads')\r\n        .select('*')\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('Error fetching leads:', error);\r\n      } else {\r\n        console.log('Fetched leads:', data?.length);\r\n        setLeads(data || []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error in fetchLeads:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function handleSignOut() {\r\n    await supabase.auth.signOut();\r\n    // Use hard redirect to ensure clean state\r\n    window.location.href = \"/admin/login\";\r\n  }\r\n\r\n  if (!authChecked) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"flex items-center space-x-2 text-amber-400\">\r\n          <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-amber-400\"></div>\r\n          <span>Checking authentication...</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen p-4\">\r\n      <motion.div \r\n        initial={{ opacity: 0, y: 20 }}\r\n        animate={{ opacity: 1, y: 0 }}\r\n        className=\"max-w-7xl mx-auto\"\r\n      >\r\n        <div className=\"bg-white/5 backdrop-blur-lg border border-white/10 rounded-2xl p-6\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between mb-6\">\r\n            <div>\r\n              <h1 className=\"text-2xl font-bold text-amber-400\">Leads Dashboard</h1>\r\n              <p className=\"text-slate-300 mt-1\">Manage your customer leads</p>\r\n            </div>\r\n            <button \r\n              onClick={handleSignOut}\r\n              className=\"px-4 py-2 rounded-lg border border-white/10 hover:bg-white/5 transition-colors text-slate-300\"\r\n            >\r\n              Sign Out\r\n            </button>\r\n          </div>\r\n\r\n          {/* Stats */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\r\n            <div className=\"bg-white/5 rounded-lg p-4 border border-white/10\">\r\n              <div className=\"text-2xl font-bold text-white\">{leads.length}</div>\r\n              <div className=\"text-slate-300 text-sm\">Total Leads</div>\r\n            </div>\r\n            <div className=\"bg-white/5 rounded-lg p-4 border border-white/10\">\r\n              <div className=\"text-2xl font-bold text-green-400\">\r\n                {leads.filter(lead => lead.is_contacted).length}\r\n              </div>\r\n              <div className=\"text-slate-300 text-sm\">Contacted</div>\r\n            </div>\r\n            <div className=\"bg-white/5 rounded-lg p-4 border border-white/10\">\r\n              <div className=\"text-2xl font-bold text-amber-400\">\r\n                {leads.filter(lead => !lead.is_contacted).length}\r\n              </div>\r\n              <div className=\"text-slate-300 text-sm\">New Leads</div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Leads Table */}\r\n          {loading ? (\r\n            <div className=\"text-center py-8 text-slate-300\">\r\n              <div className=\"flex items-center justify-center space-x-2\">\r\n                <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-amber-400\"></div>\r\n                <span>Loading leads...</span>\r\n              </div>\r\n            </div>\r\n          ) : leads.length === 0 ? (\r\n            <div className=\"text-center py-8 text-slate-300\">\r\n              No leads found in the database.\r\n            </div>\r\n          ) : (\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"w-full\">\r\n                <thead>\r\n                  <tr className=\"border-b border-white/10\">\r\n                    <th className=\"text-left p-4 text-slate-300 font-semibold\">Name</th>\r\n                    <th className=\"text-left p-4 text-slate-300 font-semibold\">Phone</th>\r\n                    <th className=\"text-left p-4 text-slate-300 font-semibold\">Email</th>\r\n                    <th className=\"text-left p-4 text-slate-300 font-semibold\">Requirement</th>\r\n                    <th className=\"text-left p-4 text-slate-300 font-semibold\">Status</th>\r\n                    <th className=\"text-left p-4 text-slate-300 font-semibold\">Created</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {leads.map((lead) => (\r\n                    <tr key={lead.id} className=\"border-b border-white/5 hover:bg-white/2 transition-colors\">\r\n                      <td className=\"p-4 text-white font-medium\">{lead.name}</td>\r\n                      <td className=\"p-4 text-slate-300\">{lead.phone}</td>\r\n                      <td className=\"p-4 text-slate-300\">{lead.email || '-'}</td>\r\n                      <td className=\"p-4 text-slate-300 max-w-xs truncate\">{lead.requirement || '-'}</td>\r\n                      <td className=\"p-4\">\r\n                        <span className={`px-3 py-1 rounded-full text-sm font-medium ${\r\n                          lead.is_contacted \r\n                            ? 'bg-green-500/20 text-green-400 border border-green-500/30' \r\n                            : 'bg-amber-500/20 text-amber-400 border border-amber-500/30'\r\n                        }`}>\r\n                          {lead.is_contacted ? 'Contacted' : 'New Lead'}\r\n                        </span>\r\n                      </td>\r\n                      <td className=\"p-4 text-slate-300 text-sm\">\r\n                        {new Date(lead.created_at || '').toLocaleDateString()}\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </motion.div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}