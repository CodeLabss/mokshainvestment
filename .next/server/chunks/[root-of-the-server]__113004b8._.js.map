{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Tarak/Desktop/mokshainvestment/mokshainvestment/app/api/admin/companies/%5Bid%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\nconst supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\n// DELETE company\r\nexport async function DELETE(req: NextRequest, { params }: { params: { id: string } }) {\r\n  try {\r\n    const { id } = params;\r\n    if (!id) return NextResponse.json({ error: \"Missing ID\" }, { status: 400 });\r\n\r\n    const { data: company, error: fetchError } = await supabase\r\n      .from(\"insurance_companies\")\r\n      .select(\"*\")\r\n      .eq(\"id\", id)\r\n      .single();\r\n\r\n    if (fetchError) return NextResponse.json({ error: fetchError.message }, { status: 404 });\r\n\r\n    if (company.logo_url) {\r\n      const filePath = company.logo_url.split(\"/\").slice(-1)[0];\r\n      await supabase.storage.from(\"company-logos\").remove([filePath]);\r\n    }\r\n\r\n    const { error: deleteError } = await supabase\r\n      .from(\"insurance_companies\")\r\n      .delete()\r\n      .eq(\"id\", id);\r\n\r\n    if (deleteError) return NextResponse.json({ error: deleteError.message }, { status: 500 });\r\n    return NextResponse.json({ success: true });\r\n  } catch (err: any) {\r\n    return NextResponse.json({ error: err.message || \"Internal server error\" }, { status: 500 });\r\n  }\r\n}\r\n\r\n// PUT update logo\r\nexport async function PUT(req: NextRequest, { params }: { params: { id: string } }) {\r\n  try {\r\n    const { id } = params;\r\n    const { logoUrl } = await req.json();\r\n    if (!id || !logoUrl) return NextResponse.json({ error: \"Missing fields\" }, { status: 400 });\r\n\r\n    const { error } = await supabase\r\n      .from(\"insurance_companies\")\r\n      .update({ logo_url: logoUrl })\r\n      .eq(\"id\", id);\r\n\r\n    if (error) return NextResponse.json({ error: error.message }, { status: 500 });\r\n    return NextResponse.json({ success: true });\r\n  } catch (err: any) {\r\n    return NextResponse.json({ error: err.message || \"Internal server error\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,MAAM,WAAW,IAAA,6NAAY,gFAE3B,QAAQ,GAAG,CAAC,yBAAyB;AAIhC,eAAe,OAAO,GAAgB,EAAE,EAAE,MAAM,EAA8B;IACnF,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,GAAG;QACf,IAAI,CAAC,IAAI,OAAO,oKAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAa,GAAG;YAAE,QAAQ;QAAI;QAEzE,MAAM,EAAE,MAAM,OAAO,EAAE,OAAO,UAAU,EAAE,GAAG,MAAM,SAChD,IAAI,CAAC,uBACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,IACT,MAAM;QAET,IAAI,YAAY,OAAO,oKAAY,CAAC,IAAI,CAAC;YAAE,OAAO,WAAW,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;QAEtF,IAAI,QAAQ,QAAQ,EAAE;YACpB,MAAM,WAAW,QAAQ,QAAQ,CAAC,KAAK,CAAC,KAAK,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE;YACzD,MAAM,SAAS,OAAO,CAAC,IAAI,CAAC,iBAAiB,MAAM,CAAC;gBAAC;aAAS;QAChE;QAEA,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,SAClC,IAAI,CAAC,uBACL,MAAM,GACN,EAAE,CAAC,MAAM;QAEZ,IAAI,aAAa,OAAO,oKAAY,CAAC,IAAI,CAAC;YAAE,OAAO,YAAY,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;QACxF,OAAO,oKAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,KAAU;QACjB,OAAO,oKAAY,CAAC,IAAI,CAAC;YAAE,OAAO,IAAI,OAAO,IAAI;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC5F;AACF;AAGO,eAAe,IAAI,GAAgB,EAAE,EAAE,MAAM,EAA8B;IAChF,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,GAAG;QACf,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,IAAI;QAClC,IAAI,CAAC,MAAM,CAAC,SAAS,OAAO,oKAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAiB,GAAG;YAAE,QAAQ;QAAI;QAEzF,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACrB,IAAI,CAAC,uBACL,MAAM,CAAC;YAAE,UAAU;QAAQ,GAC3B,EAAE,CAAC,MAAM;QAEZ,IAAI,OAAO,OAAO,oKAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;QAC5E,OAAO,oKAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,KAAU;QACjB,OAAO,oKAAY,CAAC,IAAI,CAAC;YAAE,OAAO,IAAI,OAAO,IAAI;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC5F;AACF","debugId":null}}]
}